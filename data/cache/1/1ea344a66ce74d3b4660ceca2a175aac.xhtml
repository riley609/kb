
<h1 class="sectionedit1" id="email_alert_on_ssh_login">Email Alert on SSH login</h1>
<div class="level1">

<p>
To secure your machine, there are hundred different things you can do, but the most important thing is to know what’s happening on your Machine. In that getting the alerts as soon as someone login is one of very important and must thing to do.
</p>

<p>
So, to do the same thing, you can go with two approaches:
</p>

<p>
Get the alert for some specific users as soon as they login to your machine.
Get the alert for anyone who successfully logged into your machine.
This is a small script, which you need to put at specific location to get the alerts in much better/presentable shape. Remember to change the values in the sendmail section.
</p>
<dl class="code">
<dt><a href="/kb/doku.php?do=export_code&amp;id=email_alert_of_user_ssh_login&amp;codeblock=0" title="Download Snippet" class="mediafile mf_sh">Usr_Ssh_login.sh</a></dt>
<dd><pre class="code bash"><span class="re2">user</span>=<span class="sy0">`/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span><span class="kw2">whoami</span><span class="sy0">`</span>
<span class="re2">ip</span>=<span class="sy0">`/</span>usr<span class="sy0">/</span>bin<span class="sy0">/</span><span class="kw2">last</span> <span class="sy0">|</span> <span class="kw2">head</span> <span class="re5">-1</span> <span class="sy0">|</span> <span class="kw2">awk</span> ‘<span class="br0">&#123;</span>print <span class="re4">$3</span><span class="br0">&#125;</span>’<span class="sy0">`</span>
<span class="kw3">echo</span> “Subject:SSH Login Alert \n\n User \”<span class="re1">$user</span>\” just logged into the machine from IP <span class="re1">$ip</span>” <span class="sy0">|</span> <span class="kw2">sendmail</span> <span class="re5">-F</span> “Sender Name” <span class="re5">-f</span> <span class="sy0">&lt;</span>sender <span class="kw2">id</span><span class="sy0">&gt;</span> <span class="sy0">&lt;</span>receiver <span class="kw2">id</span><span class="sy0">&gt;</span></pre>
</dd></dl>

<p>
So, to get the alerts we are going to use the above script
</p>

<p>
To get alerts when a specific user login to a machine (not all users), just put the script into the User’s home directory. To be specific, just put the script into this file “&lt;User’s home&gt;/.ssh/rc“
To get the alerts when any user login to the machine, just put the script in ssh config directory. To be specific put the script at “<strong>/etc/ssh/sshrc</strong>” and you will get the alert as soon as any user login to the machine.
</p>

</div>
